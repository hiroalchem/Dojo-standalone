<!DOCTYPE html>
<!-- saved from url=(0044)http://navi-local.com/sample/3d/sample2.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>demo</title>
</head>
<body style="">

<p>3D WebGL</p>
<script src="jquery-1.10.2.min.js"></script>
<script src="three.min.js"></script>
<script src="STLLoader.js"></script>
<script src="CanvasRenderer.js"></script>
<script src="Projector.js"></script>
<script src="TrackballControls.js"></script>
<script type="text/javascript" charset="utf-8" src="agh.sprintf.js"></script>
<script src="GridHelper.js"></script>
<script>
var APP = { };
APP.animate = function() {
	APP.renderer.render( APP.scene, APP.camera );
	APP.controls.update();
	requestAnimationFrame( APP.animate );
};

$(document).ready( function() {

	// Rendererを用意
	APP.renderer = new THREE.WebGLRenderer({ alpha: true });
	APP.renderer.setSize(window.innerWidth, window.innerHeight);
	document.body.appendChild( APP.renderer.domElement );
	//APP.renderer.enable(APP.renderer.CULL_FACE);

	 // Cameraを用意
	APP.camera = new THREE.PerspectiveCamera();
	APP.camera.position.z = 200;

	// Sceneを用意
	APP.scene = new THREE.Scene();
	APP.scene.add( APP.camera );

	//ライトを用意
	var directionalLight = new THREE.DirectionalLight(0xffffff);
	directionalLight.position.y = 1000;
	directionalLight.position.z = 1000;
	APP.scene.add( directionalLight );
	var aLight = new THREE.AmbientLight( 0x909090 ,1 );
	APP.scene.add( aLight );
	
    //グリッド
    grid = new THREE.GridHelper(400, 10, 0x000000, 0x000000);
    grid.position.y = 0;
    APP.scene.add(grid);
	
    // Add stl objects and a name
	function addSTLObject(url, name, objcolor) {
    	var loader = new THREE.STLLoader();
    	loader.load(url, function (geometry) {
			var material = new THREE.MeshLambertMaterial( { color: objcolor } ); //ambient: 0xff0000, 
        	var mesh = new THREE.Mesh(geometry, material);
        	APP.scene.add(mesh);
        	mesh.name = name;
        	mesh.scale.set( 1,1,1);
			mesh.material.side = THREE.DoubleSide;
        	APP.scene.add(mesh);
			//APP.scene.getObjectByName('test_name2').rotation.x += 0.005;
			//APP.scene.getObjectByName('test_name2').rotation.y += 0.005;
			console.log('Name check');
			console.log(APP.scene.getObjectByName(name));
        	//APP.scene.remove(mesh);
    	});
		}
	
    // Remove a stl object by a name after generation.
	function removeSTLObject(name) {
		var obj = APP.scene.getObjectByName(name);
		console.log(obj);
		APP.scene.remove(obj);
		}
	
	
	//addSTLObject('./maxsize_obj_.stl','test_name2', 0x0022ff);
	
	for (  var i = 1;  i < 20;  i++  ) {
		var filename = sprintf("./imgs/id%d.stl", i );
		var id       = sprintf("%d", i );
		console.log(filename);
		addSTLObject(filename, id, (255-i*10)*256*256+100*256+i*10);
	}
	addSTLObject('./imgs/id23.stl','test_name1', 0xff2200);	
	
	//var obj = APP.scene.getObjectByName('test_name');
	//console.log(obj);
	//APP.scene.remove(obj);

				
	// Controlsを用意
	APP.controls = new THREE.TrackballControls( APP.camera );
	APP.controls.rotateSpeed = 20.0;
	APP.animate();

	//removeSTLObject('test_name1');
	
});


</script>

</body>
</html>



